"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[773],{438:(e,t,i)=>{var n=i(306);const s={initialized:!1};var r=i(496),a=i.n(r);var o={};o.create=function(e,t,i){return n={x:e/i,y:t},[a().createSnapGrid(n)];var n};const d=o;var l={grid:null,size:null,timestamps:null},c={x:0,y:0},u=null;l.resource=function(e){a().isSet(e)||(a()(e).dropzone({listeners:{dragenter:function(e){e.target.classList.add("droppable")},dragleave:function(e){e.target.classList.remove("droppable")},drop:function(e){var t=e.target,i=e.relatedTarget,n={id:parseInt(i.dataset.id),user_id:parseInt(i.dataset.user),start_time:parseInt(i.dataset.start),end_time:parseInt(i.dataset.end),resource_id:parseInt(t.dataset.id)},s=Math.round((i.getBoundingClientRect().left-t.getBoundingClientRect().left)/t.clientWidth*l.timestamps.duration+l.timestamps.start),r=n.end_time-(n.start_time-s);n.start_time=s,n.end_time=r;var a=document.createElement("div");a.classList.add("progress"),i.appendChild(a),t.dispatchEvent(new CustomEvent(e.dragEvent.altKey?"createbooking":"updatebooking",{detail:n})),i.classList.remove("droppable"),c={x:0,y:0}}}}),a()(e).on("doubletap",(function(e){if(e.target.classList.contains("segel-resource")||e.target.classList.contains("segel-bookings")){var t=e.target.classList.contains("segel-resource")?e.target:e.target.parentNode,i=Math.round(e.offsetX/t.clientWidth*l.timestamps.duration),n=Math.round(l.timestamps.duration/l.steps),s=i+l.timestamps.start,r=s+2*n;t.dispatchEvent(new CustomEvent("createbooking",{detail:{resource_id:parseInt(t.dataset.id),start_time:s,end_time:r}}))}})))},l.booking=function(e){!a().isSet(e)&&e.classList.contains("editable")?(a()(e).draggable({listeners:{start:function(e){e.altKey&&(u=e.target.cloneNode(!1),e.target.parentNode.appendChild(u)),e.target.classList.add("is-dragging")},move:function(e){c.x+=e.dx,c.y+=e.dy,e.target.style.transform="translate(".concat(c.x,"px, ").concat(c.y,"px)")},end:function(e){e.target.classList.remove("is-dragging"),u&&(e.altKey?l.booking(u):u.parentNode.removeChild(u),u=null)}},modifiers:[a().modifiers.restrict({restriction:".segel-resources"}),a().modifiers.snap({targets:l.grid,offset:"startCoords"})]}),a()(e).resizable({edges:{top:!1,bottom:!1,left:".segel-resize-handle__left",right:".segel-resize-handle__right"},listeners:{start:function(e){e.target.classList.add("is-resizing")},move:function(e){var t=e.target.dataset,i=t.x,n=t.y;i=(parseFloat(i)||0)+e.deltaRect.left,n=(parseFloat(n)||0)+e.deltaRect.top,Object.assign(e.target.style,{width:"".concat(e.rect.width,"px"),height:"".concat(e.rect.height,"px"),transform:"translate(".concat(i,"px, ").concat(n,"px)")}),Object.assign(e.target.dataset,{x:i,y:n})},end:function(e){var t=e.target,i=t.parentNode,n=t.dataset.x;n=parseFloat(n)||0;var s={id:parseInt(t.dataset.id),user_id:parseInt(t.dataset.user),start_time:parseInt(t.dataset.start),end_time:parseInt(t.dataset.end),resource_id:parseInt(i.dataset.id)},r=Math.round((t.getBoundingClientRect().left-i.getBoundingClientRect().left)/i.clientWidth*l.timestamps.duration+l.timestamps.start),a=Math.round(t.getBoundingClientRect().width/i.clientWidth*l.timestamps.duration+r);s.start_time=r,s.end_time=a;var o=document.createElement("div");o.classList.add("progress"),t.appendChild(o),i.parentNode.dispatchEvent(new CustomEvent("updatebooking",{detail:s})),e.target.classList.remove("is-resizing")}},modifiers:[a().modifiers.restrict({restriction:".segel-resources"}),a().modifiers.restrictSize(l.size),a().modifiers.snap({targets:l.grid,offset:"startCoords"})]}),a()(e).on("doubletap",(function(e){e.target.closest(".segel-resource").dispatchEvent(new CustomEvent("deletebooking",{detail:{id:parseInt(e.target.dataset.id)}}))}))):e.classList.contains("editable")||a()(e).unset()};const p=l;function m(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return f(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,s=function(){};return{s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){o=!0,r=e},f:function(){try{a||null==i.return||i.return()}finally{if(o)throw r}}}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function g(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var h=i(667);n.Z.data("resourceTree",(function(e){var t,i,n;return{visible:null===(t=e.visible)||void 0===t||t,expanded:null!==(i=e.expanded)&&void 0!==i?i:[],selected:null!==(n=e.selected)&&void 0!==n?n:[],date:e.date,datepicker:null,debounceExpanded:null,debounceSelected:null,multipleSelect:function(e){if(!e.target.classList.contains("hidden")&&e.altKey){var t=e.target.closest(".resourcelist-category"),i=Array.from(t.querySelectorAll(":scope > .resourcelist-children > .resourcelist-resource input")),n=i.filter((function(e){return e.checked}));if(i.length===n.length){var s=n.map((function(e){return e.value}));this.selected=this.selected.filter((function(e){return-1===s.indexOf(e)}))}else{var r=i.filter((function(e){return!e.checked})).map((function(e){return e.value}));this.selected=this.selected.concat(r)}e.preventDefault()}},init:function(){var e=this;this.$watch("expanded",(function(t){s.initialized&&(clearTimeout(e.debounceExpanded),e.debounceExpanded=setTimeout((function(){e.$dispatch("segel-setexpanded",t)}),1e3))})),this.$watch("selected",(function(t){clearTimeout(e.debounceSelected),e.debounceSelected=setTimeout((function(){s.initialized?e.$dispatch("segel-setresources",t):e.$refs.form.submit()}),1e3)})),window.livewire.on("dateChanged",(function(t){e.date=t.date,e.datepicker.setDate(e.date,!1)})),this.datepicker=flatpickr(this.$refs.datepicker,{allowInput:!0,altFormat:"Y-m-d",dateFormat:"Y-m-d",time_24hr:!0,onChange:function(t,i,n){var r=new Date(t[0].getTime()-60*t[0].getTimezoneOffset()*1e3).getTime()/1e3;s.initialized?e.$dispatch("segel-settimestamps",{start:r}):e.$refs.form.submit()}})}}})),n.Z.data("segel",(function(e){var t;return{start:e.start,duration:e.duration,steps:e.steps,current:0,init:function(){var e=this;setInterval((function(){e.current=Math.round(((new Date).getTime()-60*(new Date).getTimezoneOffset()*1e3)/1e3)}),1e3),this.setupTimestamps(),this.calculateGrid(),this.setupInteractions(),this.$watch("start, duration, steps",this.setupTimestamps),window.Livewire.hook("message.processed",(function(t,i){"segel"===i.name&&e.setupInteractions()})),s.initialized=!0},base:(t={},g(t,"x-on:resize.window.debounce.500",(function(){this.handleResize()})),g(t,"x-on:segel-setexpanded.window",(function(e){this.$wire.setExpanded(e.detail)})),g(t,"x-on:segel-setresources.window",(function(e){this.$wire.setResources(e.detail)})),g(t,"x-on:segel-settimestamps.window",(function(e){this.$wire.setTimestamps(e.detail)})),t),setupTimestamps:function(){p.steps=this.steps,p.timestamps={start:this.start,duration:this.duration}},setupInteractions:function(){this.$el.querySelectorAll(".segel-resource").forEach(p.resource),this.$el.querySelectorAll(".segel-booking").forEach(p.booking)},calculateGrid:function(){p.grid=d.create(this.$el.clientWidth,41,this.steps),p.size={min:{width:this.$el.clientWidth/this.steps,height:1},max:{width:this.$el.clientWidth,height:41}}},handleResize:function(){this.calculateGrid();var e,t=m(this.$el.querySelectorAll(".segel-booking"));try{for(t.s();!(e=t.n()).done;){var i=e.value;if(a().isSet(i)){var n=a()(i).draggable(),s=a()(i).resizable();n.modifiers[1].options.targets=p.grid,s.modifiers[2].options.targets=p.grid,s.modifiers[1].options.min=p.size.min,s.modifiers[1].options.max=p.size.max}}}catch(e){t.e(e)}finally{t.f()}}}})),n.Z.data("quickBook",(function(e){var t,i;return{isOpen:null!==(t=e.isOpen)&&void 0!==t&&t,start_time:e.start_time,end_time:e.end_time,resource_id:null!==(i=e.resource_id)&&void 0!==i?i:0,startTimeDatepicker:null,endTimeDatepicker:null,init:function(){var e=this;this.startTimeDatepicker=(0,h.Z)(this.$refs.start_time,{allowInput:!1,altFormat:"Y-m-d H:i",dateFormat:"Y-m-d H:i",time_24hr:!0,enableTime:!0,onChange:function(t,i,n){e.endTimeDatepicker.selectedDates[0]<t[0]&&e.endTimeDatepicker.setDate(t[0].getTime()+72e5),e.endTimeDatepicker.set("minDate",t[0])}}),this.endTimeDatepicker=(0,h.Z)(this.$refs.end_time,{allowInput:!1,altFormat:"Y-m-d H:i",dateFormat:"Y-m-d H:i",time_24hr:!0,enableTime:!0})},outsideClick:function(e){this.isOpen&&(e.target.closest(".flatpickr-calendar")||(this.isOpen=!1))}}})),window.Alpine=n.Z,n.Z.start(),window.interact=a(),window.flatpickr=h.Z},580:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[170,898],(()=>(t(438),t(580))));e.O()}]);